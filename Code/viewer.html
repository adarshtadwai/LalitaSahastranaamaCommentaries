<!DOCTYPE html>
<html lang="sa">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lalita Sahasranama - Soubhagya Bhaskara Commentary</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Annapurna+SIL:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        /* Additional viewer-specific styles */
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .navigation {
            position: sticky;
            top: 0;
            background: white;
            padding: 15px;
            border-bottom: 2px solid #DAA520;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            z-index: 100;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .nav-button {
            background: #8B4513;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s;
        }

        .nav-button:hover {
            background: #8B0000;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .nav-button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .name-selector {
            padding: 8px 15px;
            font-size: 1.1em;
            font-family: 'Annapurna SIL', 'Noto Sans Devanagari', sans-serif;
            border: 2px solid #DAA520;
            border-radius: 5px;
            background: #fff8dc;
        }

        .content {
            padding: 20px;
        }

        .loading {
            text-align: center;
            padding: 50px;
            font-size: 1.5em;
            color: #8B4513;
        }
    </style>
</head>
<body>
    <div class="navigation">
        <button class="nav-button" id="prevBtn" onclick="navigate(-1)">← Previous</button>

        <select class="name-selector" id="nameSelector" onchange="loadName(this.value)">
            <option value="">Select Name...</option>
        </select>

        <button class="nav-button" id="nextBtn" onclick="navigate(1)">Next →</button>
    </div>

    <div class="container">
        <div class="content" id="content">
            <div class="loading">Loading...</div>
        </div>
    </div>

    <script>
        let currentNumber = 1;
        const totalNames = 1000;

        // Initialize dropdown with all names
        async function initializeDropdown() {
            const selector = document.getElementById('nameSelector');

            // You can load this from a JSON file or fetch from the markdown files
            for (let i = 1; i <= totalNames; i++) {
                const option = document.createElement('option');
                option.value = i;
                option.textContent = `${i.toString().padStart(4, '0')} - Loading...`;
                selector.appendChild(option);
            }
        }

        // Load markdown file and convert to HTML
        async function loadName(number) {
            if (!number) number = currentNumber;
            currentNumber = parseInt(number);

            const filename = `../SoubhagyaBhaskara/${currentNumber.toString().padStart(4, '0')}.md`;

            try {
                const response = await fetch(filename);
                if (!response.ok) throw new Error('File not found');

                let markdown = await response.text();

                // Remove YAML front matter
                markdown = markdown.replace(/^---[\s\S]*?---\n/, '');

                // Convert markdown to HTML
                const html = marked.parse(markdown);

                document.getElementById('content').innerHTML = html;
                document.getElementById('nameSelector').value = currentNumber;

                // Update button states
                document.getElementById('prevBtn').disabled = (currentNumber === 1);
                document.getElementById('nextBtn').disabled = (currentNumber === totalNames);

                // Update page title
                const h1 = document.querySelector('h1');
                if (h1) {
                    document.title = h1.textContent + ' - Lalita Sahasranama';
                }

            } catch (error) {
                document.getElementById('content').innerHTML =
                    `<div class="loading">Error loading name ${currentNumber}: ${error.message}</div>`;
            }
        }

        // Navigate between names
        function navigate(direction) {
            const newNumber = currentNumber + direction;
            if (newNumber >= 1 && newNumber <= totalNames) {
                loadName(newNumber);
            }
        }

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowLeft') navigate(-1);
            if (e.key === 'ArrowRight') navigate(1);
        });

        // Initialize
        initializeDropdown();
        loadName(1);
    </script>
</body>
</html>
